
Space - System integration demo

libv.rev: Implement shader management
app.space: Improve arrow with geometry shader
app.space: Add grid
visual.grid: Make a pretty grid: Blender grid is awesome. Implement it:
visual.grid: For grids expand and fade out line endings
visual.grid: For grids fade out lines based on ray incident angle, lines should fade into the sky-box as seamlessly as possible
visual.grid: For grids fade out small lines based on distance from the camera and make higher grid lines more visible
visual.editor_bg: Non uniform color, use a grainy texture (like blue noise)
app.space: Move origin gizmo into top right corner into screen space
app.space: Burn a frame icon set into the binary and use it
app.space: Have space working from the correct dir
app.space: Screen picker integration - Place something onto the 3D world on mouse click
app.space: Fleet that moves (without any arrow)
app.space: Cleanup the shader error overlay code (PanelStatusLog + UIEventHub)
app.space: Sim state manipulation only with commands
app.space: Fleet with arrow and movement toward target (primitive)
app.space: Add support for command arrow 'intent' (color) specification
app.space: Revive the original debug arrow spiral
app.space: Implement a more complete test arrow set (parallel, different length, star, spiral, rings, multiple chains with different rotation angles)
app.space: Add support for command arrow animation offset
app.space: Add support for chained command arrows
app.space: Basic hacky networking
libv.ui: Add overlay events to the global events, then use those to alter controls input ignore (attach can auto do this)
app.space: Cannibalize style.lua from vm4_viewer
app.space: Rename player -> user (and the ID, and the members vars in CTOs)
app.space.net: Networking (Stage 2)
app.space.net: Introduction with name, Protocol messages
app.space.net: Lobby with list of connected clients
app.space.net: Implement lobby snapshot sending/loading on connect
app.space: Solve canvas and ui ctrl conflict
app.space: Commands have a conflicting name, resolve it with an acronym like CTO (Command Transfer Object)
app.space: Structure the whole program: UML time is upon us | Still not the cleanest, but improved
app.space: 3D fleet picking
app.space: Selected fleet highlight
app.space: edge highlight (fresnel shader) https://forum.playcanvas.com/t/solved-custom-shader-fresnel/17355
app.space: 3D secondary fleet picking
app.space: Fleet selection, selection based commands
app.space: Multi fleet selection
app.space: Rename files *_behaviour -> *_control
app.space: Move cto apply functions into universe
app.space: Move canvas and camera files under view
app.space: Adopt libv.rev post-processing
app.space: Default focus canvas
app.space: Add Controls help overlay (Simple, list only)
app.space: Fleet visualisation with a simple model and orientation
libv.rev: Bloom textures should not repeat, they could clamp
app.space: F1 menu, list every control bindings
app.space: Implement basic 2D text rendering over a 3D anchor point
app.space: Implement Universe Snapshots

















--- STACK ------------------------------------------------------------------------------------------



app.space: Debug views and grid on/off (and other options) with persistence

app.space: Map generation

app.space: Direction idea:
		Create a working UI mockup project
		Create a working sim mockup project
		Create a working render mockup project
		Merge them





app.space: Selection state storage
		selectedFleetIDList have to die, or became a better index
app.space: 'Universe' Snapshot need for unsynchronized / non-snapshot members in Universe
		| Solution: Special archives with members to indicate the reason for the serialization, and inside the serializers branching on this info
		| Disadvantage: 'Local' members makes the otherwise immutable view for universe mutable







app.space: Controls: Clicking on shuffle button deselects
		| feature_binary_raii
app.space: Controls: Clicking and rotating the camera it deselects
		| Should analog features have priority over action/binary?
				Or does (0,0) 'magic' happens and that causes the issue?




Bug P1: repeated smashing of host/join can cause failure
		| Also: Simple disconnect as a non connected client will do long timeout
Bug P1: app.space: "Space" title button is mouse shielded by the canvas
		| Maybe mouse movement only | Dont think so
			Should be a mouse order issue
Bug P3: app.space: Model loading failure causes silent error and soft-lock
			Who catches that exception and why?
Performance Bug P4: app.space: 200*200 debug sphere causes low fps
		| debug shapes have to switch to pre-uploaded meshes





Main areas of focus: Cost / Value
	40 / 6: Control: Ctrl box selection support
			| Maybe enough if we switch to binary feature for now
				Good start, but need some working on the conflict

	60 / 4: Library: State machine generation
	12 / 4: Library: Shader / Uniform block generation

	10 / 1: Visual: Fleet selecting 4 corner animation / highlight effect

	app.space: Main menu
	app.space: In game menu
	app.space: Multiplayer lobby list
	app.space: Planets
	app.space: Map generation with lua
	app.space: Factions
	libv.ui: Component / Style composition


libv.rev: PostProcess should respect original framebuffer and viewport values

libv.ctrl: Box selection support
		start
			[press]
		update tick
			[hold]
		end
			[release]
libv.ctrl: Accidental collusion with Ctrl+A[press] and A[hold]
libv.ctrl: Late enter of feature_binary: On context_enter call any binary feature that would become active with the current state
libv.ctrl: 'Acquire "mouse"' similarly as UI does it
libv.ctrl: arg.reject_feature(); aka a way to reject the feature activation from within the feature: in this case the next candidates would be called




place.it:
	ext: Adopt expected (should be coming in C++23): https://github.com/TartanLlama/expected

	ranges chunk, pairwise and slide (might be in ranges::v3, but planned to come with C++23)
		std::views::chunk(column_count)
			could replace the column count view used by ui grid
		std::views::pairwise
		std::views::slide(number_of_nlets)
			could replace the adjacent_pair algo is called with number_of_nlets=2

	fmt::print("{}", container);
	fmt::print("{}", container | view::join(":"));

watch.it:
	vue cc - https://www.youtube.com/watch?v=qZXt1Aom3Cs



app.space.net: Networking
	app.space.net: Networking (Stage 3)
		app.space.net: Connection stages and states
		app.space.net: Snapshot
			app.space.net: Snapshot saving
			app.space.net: Snapshot sending upon newly connected client (with pause)
			app.space.net: Snapshot loading
			app.space.net: ? Non-snapshot data members (fleet selection)
		app.space.net: Smooth Snapshot
			app.space.net: Non paused snapshot join
				app.space.net: Fast forwarding after a snapshot loading happened
				app.space.net: Apply, update, skip render repeat until catch up
			app.space.net: [Optional] Snapshot delta to help catchup
		app.space.net: Snapshot compression above X KB (64)

	app.space.net: Networking (Stage 4)
		app.space.net: Deterministic execution (Frame Index and lockstep)
		app.space.net: Latency prediction
		app.space.net: Latency hiding

	app.space.net: Networking leftovers
		app.space.net: Timer to kick "connectings" after X sec if they dont identify (Intro) themselves
		app.space.net: Implement lobby status event
		app.space.net: Implement lobby chat message event
		app.space: Mini canvas show other clients view



app.space.net: Networking PAPER:
	Some random buzz words:
		Deterministic lockstep
		snapshot
		delta update
		playout delay buffer
		adaptive playout delay



app.space: Simulation time control
	app.space: Pause, Unpause (It will be a good practise for timers and controls)
	app.space: Speed x1 x2 x4
	app.space: Speed hotkeys: 0,1,2,3 = set, space = toggle pause and last non pause speed

app.space: Cannibalize config.hpp from vm4_viewer (but maybe change it to CTRP, investigate it)











CI/CD:
	jenkins: pull
	jenkins: build (parameterized with branch and version number (and git commit count))
	jenkins: package
	jenkins: ssh upload the release package to the update master
	jenkins: trigger the update master
	update-master: by default every release marked as internal
	update-master: on some GUI mark this release not internal and mark update routes to be built
	jenkins could ping update-master on build start (option to auto release feature)


app.space: Simulation
	app.space: On fleet command completion in chain: Do not waste energy, roll the excess 'movement time' into the next command

app.space: RendererDebug
	DONE: color property
	DONE: line, triangle, quad, disc
	DONE: sphere:
		DONE: UV sphere, tessalation in renderer.cpp instead of canvas.cpp
    DONE: frustum: 5 points, 1 quad, 4 sides
    circle, [box]
    plane
    2D shapes in screen space(rectangle)
	--------------
	orientation (aka gizmo with colored endpoints)
    arrow (not command arrow, but a 3D arrow model)
    2D shapes in screen space(point, triangle, line, circle)

app.space: Fleet merge/follow/attack commands
	app.space: 3D fleet box selection:
		a: local coordinates starting anchor
		b: world space starting anchor
	app.space: 2.5D fleet box selection:
		a: rectangle selection on grid
		b: frustum selection (TODO: plane model: 4 float, frustum model)
		edge case: inf (clicking on sky, negative testing)

	app.space: hover fleet highlight
		not selected - not Network
        primary/secondary hit hover - not Network
        box hover - not Network
        selected - Network
	app.space: deselect


	//app.space: Fleet factions
app.space: Selection structure
	- General API over the current selection whatever types those maybe, whatever API client code might need
	-it can go into GameState as well as Universe




app.space: Main structure paper OUTDATED

	game instance (desktop) - GameInstance (an object spawned when you launch the application and that remains the same until you close it)
		frame
		controls
		nexus
		settings
		user/player
		ui
		ui main (mp bar, shader overlay)
			renderer(s)
			session (aka old game mode) - GameSession (spawned when a level is loaded)
				[Network base]
				[Network server]
				[Network client]
				gamemode (aka new control concept)
				universe - GameState (spawned by the gameMode)
				playout
				canvas
					& renderers
				ui session (cmd bar)
				ui session mp (mp mini canvas list)

				PlayerController [UI, Controls]
					PlayerState (spawned when a PlayerController is spawned = when a player arrives in the game)

	game.sim:
		- Command based sim state manipulation | Playout
			Types:
			- Control tracking (Camera / Mouse movement, ?Selection)
			- Sim state manipulation (Move, Attack, Production command, ?Selection)
			- Session manipulation (Permission alteration, Kick, Ban, etc)





app.space: Self-Updater

app.space: frustum visualization
app.space: Add multi camera / camera frustum visualization (uniforms and C++ clipping from the main camera, but view from another)
app.space: Camera: Pressing the camera alteration in one direction for long time (>1-3s) increase speed

app.space: Optimized VAO update for command arrows (prepare / render step is done, mesh re-upload and glr side should be checked)

app.space: Fleet name display (UI Label / Unit plates) 2D<->3D UI layout
app.space: Fleet visualization (render separate ships and group art)
	app.space: Generate random number of ships and position them appropriately (simple mesh)
	app.space: Movement, momentum, turning
	app.space: Different fleet shapes (?blockade as shape)
	app.space: Modernize and integrate model rendering for ships in fleets (from vm4_viewer)


app.space: Command arrow improvements
	app.space: Add support for source position offset (Instead of origin use an offset toward the heading direction)
	app.space: Add support for target position offset (Instead of origin use an offset from the incoming direction)
	app.space: Arrow strip placement control from lua (or something lua related) (With auto reload and everything)
	app.space.visual: Command arrow add a glossy holo texture (~simple cloud mixture) to the arrows body (idea come from flowstorm's checkpoint body)
	app.space.visual: Command arrow make the edges less bright to help with AA edge

app.space: Line shader (Geometry shader with custom width support) (<1px width = transparency at 1 px)

app.space: Iris and space has to merge in some way
	iris: Make a main menu

app.space: headless server
	To optimize the binary size and skip linking in shit for headless,
	a separate executable needed without any symbol usage of non-headless gamemode



visual.shader: glow net: https://www.youtube.com/watch?v=3CycKKJiwis

watch shader part 3 https://www.youtube.com/watch?v=E4PHFnvMzFc


What do I need from libv to make a 'minimal' working iris program?
	libv.ui
		2 List component
		3 Scroll pane = scroll area + scroll bar + connecting them
		5 Font outline render
			freetype2 Now has an SDF render option
			spread property set:
				const FT_Int spread = 8;
				FT_Property_Set(library, "sdf", "spread", &spread);
				8bit uint normalized to [+spread .. -spread]
			(There is also a newly found lib: https://github.com/Chlumsky/msdfgen and https://github.com/Chlumsky/msdf-atlas-gen)

	libv.ctrl
		4 Interaction with UI
		5 Resolve analog-binary accidental collusion with time

	libv.serial
		3 Safe container resize/reserve on deserialization

	libv.update
		Resource
			1 Working resource download protocol
			1 Update/Resource signature verification
		Working update
			1 Self update support
			1 Marry Resource and Update
		Deployment
			2 Scripts to create a new build and deploy to libv.update servers

	libv.state
		5 Generated source for state machines

blur: (shaders are already implemented in app.space, but downscaling is not) https://www.youtube.com/watch?v=uZlwbWqQKpc
		full screen quad pass with render_resolution / 2 with v blur shader
		full screen quad pass with render_resolution / 2 with h blur shader
		full screen quad pass with render_resolution / 8 with v blur shader
		full screen quad pass with render_resolution / 8 with h blur shader



--- Article collection -----------------------------------------------------------------------------

Infinite Grid: http://asliceofrendering.com/scene%20helper/2020/01/05/InfiniteGrid/
CMake source generation step: https://crascit.com/2017/04/18/generated-sources-in-cmake-builds/
Deterministic Lockstep: https://gafferongames.com/post/deterministic_lockstep/


